<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>New Gen Patio</title>
    <meta name="robots" content="index, follow, max-image-preview:large" />
    <meta name="theme-color" content="#ffffff" />

    <link rel="icon" href="/LogoColor.ico" />
    <link rel="shortcut icon" href="/LogoColor.ico" />

    <link
      rel="preload"
      as="image"
      href="/assets/videos/homevideo-poster.jpg"
      imagesizes="100vw"
      fetchpriority="high"
    />

    <link rel="dns-prefetch" href="https://www.googletagmanager.com" />
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin />
    <link rel="dns-prefetch" href="https://firebaseinstallations.googleapis.com" />
    <link rel="preconnect" href="https://firebaseinstallations.googleapis.com" crossorigin />
    <link rel="dns-prefetch" href="https://analytics.tiktok.com" />
    <link rel="preconnect" href="https://analytics.tiktok.com" crossorigin />

    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){ dataLayer.push(arguments); }
      gtag('consent', 'default', {
        ad_storage: 'denied',
        ad_user_data: 'denied',
        ad_personalization: 'denied',
        analytics_storage: 'denied',
        wait_for_update: 500
      });
    </script>

    <meta name="msvalidate.01" content="C5F1F81EC9077D133C4527AB41B34993" />
  </head>

  <body>
    <script> if (location.pathname === "/index.html") location.replace("/"); </script>

    <div id="root"></div>

    <div
      id="cookie-popup"
      class="cookie-popup"
      role="dialog"
      aria-modal="true"
      aria-live="polite"
      aria-label="Cookie consent dialog"
      tabindex="-1"
    >
      <p id="cookie-text" class="cookie-text">This website uses cookies to enhance the user experience.</p>
      <button id="accept-cookies" class="cookie-btn cookie-btn--accept">Accept</button>
      <button id="close-cookies" class="cookie-btn cookie-btn--close" aria-label="Close cookie banner">Close</button>
    </div>

    <style>
      .cookie-popup{
        position: fixed; left: 0; right: 0; bottom: 0;
        background: #000; color: #fff;
        padding: 14px 16px calc(14px + env(safe-area-inset-bottom, 0));
        display: flex; justify-content: center; align-items: center; gap: 12px;
        z-index: 9999;
        transform: translateY(110%);
        transition: transform .25s ease;
        will-change: transform;
        contain: layout paint style;
        box-shadow: 0 -2px 10px rgba(0,0,0,.25);
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      }
      .cookie-popup.is-visible{ transform: translateY(0); }
      .cookie-text{ margin: 0; font-weight: 600; }
      .cookie-btn{ cursor: pointer; border: none; border-radius: 8px; padding: 8px 16px; font-weight: 600; }
      .cookie-btn--accept{ background:#ff6a00; color:#fff; }
      .cookie-btn--close{ background:transparent; color:#fff; border:1px solid #fff; }
      @media (max-width: 480px){
        .cookie-popup{ flex-direction: column; gap: 10px; align-items: stretch; }
        .cookie-btn{ width: 100%; }
      }
      @media (prefers-reduced-motion: reduce){ .cookie-popup{ transition: none; } }
    </style>

    <script>
      // Lógica de traducción del banner de cookies
      (function() {
        const isSpanish = window.location.pathname.includes('/es');
        if (isSpanish) {
          document.getElementById('cookie-text').innerText = "Este sitio web utiliza cookies para mejorar su experiencia.";
          document.getElementById('accept-cookies').innerText = "Aceptar";
          document.getElementById('close-cookies').innerText = "Cerrar";
        }
      })();

      function afterWindowLoad(fn){
        if (document.readyState === 'complete') fn();
        else window.addEventListener('load', fn, {once:true});
      }

      function loadTrackingScripts() {
        // GTM
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
          'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-NVRGTGFV');

        // Consent Granted
        if (typeof gtag === 'function') {
          gtag('consent', 'update', {
            ad_storage: 'granted',
            ad_user_data: 'granted',
            ad_personalization: 'granted',
            analytics_storage: 'granted'
          });
        }

        // GA4
        const ga = document.createElement('script');
        ga.src = 'https://www.googletagmanager.com/gtag/js?id=G-KQH5V68PG7';
        ga.async = true;
        document.head.appendChild(ga);
        ga.onload = () => {
          gtag('js', new Date());
          gtag('config', 'G-KQH5V68PG7');
          gtag('config', 'AW-16836532366');
        };

        // Meta Pixel
        (function(f,b,e,v,n,t,s){
          if(f.fbq)return;n=f.fbq=function(){n.callMethod? n.callMethod.apply(n,arguments):n.queue.push(arguments)};
          if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
          n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;
          s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s);
        })(window, document, 'script', 'https://connect.facebook.net/en_US/fbevents.js');
        if (window.fbq){ fbq('init','982749890451861'); fbq('track','PageView'); }

        // HubSpot, TikTok, Clarity, Metricool...
        (function(){
          var hs=document.createElement("script");
          hs.type="text/javascript"; hs.id="hs-script-loader"; hs.async=true; hs.defer=true;
          hs.src="https://js-eu1.hs-scripts.com/146616264.js";
          document.head.appendChild(hs);
        })();

        // Clarity
        (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "sfe81s7o56");
      }

      document.addEventListener('DOMContentLoaded', function() {
        const popup = document.getElementById('cookie-popup');
        const accepted = localStorage.getItem('cookiesAccepted') === '1';

        if (!accepted){
          requestAnimationFrame(() => popup.classList.add('is-visible'));
        } else {
          afterWindowLoad(loadTrackingScripts);
        }

        document.getElementById('accept-cookies').addEventListener('click', () => {
          localStorage.setItem('cookiesAccepted','1');
          popup.classList.remove('is-visible');
          afterWindowLoad(loadTrackingScripts);
        });

        document.getElementById('close-cookies').addEventListener('click', () => {
          popup.classList.remove('is-visible');
        });
      });
    </script>

    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>